

# WEEK 7

```
[이 주의 과제]
1. 디자인 패턴 중 3가지 선택- 예: 싱글톤, 팩토리, 어댑터 (디자인 패턴 사용 이유, 예제, 조심해야 할 점)
2. 스프링의 IoC(Inversion of Control)과 DI(Dependency Injection)에 대해 설명하시오
3. 스프링 빈 주입 방법에 대해 설명하시오
4. Spring AOP(Aspect-Oriented Programming)에 대해 설명하시오
5. Git Branch 전략에 대해 설명하시오 (eg. git flow, github flow, etc)
```



## [자문자답]


----------


### 1. 디자인 패턴 중 3가지 선택- 예: 싱글톤, 팩토리, 어댑터 (디자인 패턴 사용 이유, 예제, 조심해야 할 점)

#### (1) [Factory Pattern]
> ##### `입력에 따라 생성해야 하는 객체들이 다를 때` 더 잘 관리하기 위해 사용하는 패턴입니다. 객체들을 생성하는 팩토리라는 클래스를 이용해 `각 팩토리에 맞는 객체 생성을 돕는 메서드를 제공`하는 것입니다. 실제 코드는 [여기](https://github.com/choichanhyeok/just-java-note/tree/master/src/main/java/org/example/designPattern/factory/case2AboutDao)에 작성해뒀습니다.
```
아래 코드 비교를 통해서 확인할 수 있는 장점은 아래와 같습니다.

a. 중복 코드를 줄였습니다. 분기에 따른 객체 생성량이 많아질수록 중복 코드를 줄이게 됩니다.
b. OCP를 준수할 수 있게 됩니다. 만약에 저 test thread에서 사용하는 객체를 다른 버전으로 변경해야할 일이 생기더라도 팩토리 내부에서 해당 객체를 수정해주면 됩니다. 이는 의존성 분리와 코드 유지보수성 향상의 이점을 얻을 수 있다고 보입니다.
```
```
아래 코드 비교를 통해서 확인할 수 있는 단점은 아래와 같습니다.

a. 결국 관계성이라는게 생겨서 저 dao의 실제 구현체를 확인하고 싶은 사람들은 팩토리를 거쳐 dao클래스를 찾아 가야 합니다.
b. 결국 팩토리 패턴은 추가적인 추상화 계층을 더하고 관계성을 추가하는거여서 초기 구현 과정을 복잡하게 만들 수 있습니다. 그리고 클라이언트에서 이를 관리해야 하는 경우라면 유지보수성에 악영향을 줄 수 있습니다.
c. dao를 하나 더 추가해 저 test thread에 관련 기능을 추가하고 싶다고 할 때 기존에는 그냥 해당 dao만 주입받든 생성하든 써주면 되는데 팩토리를 사용하면 팩토리 클래스들, 그러니까 지금 같은 경우는 오라클이랑 mysql에 다 추가를 해줘야합니다.
    더군다나 지금처럼 appConfig를 직접 관리해서 의존성 주입을 받는다고 할 때는 총 3개의 클래스에 관련 내용을 추가해야합니다.
```
![image](https://github.com/chanHyeoks-kingdom/f-lab-history/assets/68278903/d435f77c-d4a8-4412-88d2-e9e75f9a70b6)

<br>

<details>
<summary> 꼬리질문 1. </summary>

###### 꼬리질문 1. 실제 사용 사례가 어떤게 있나요?

```
스프링의 BeanFactory라고 ApplicationContext의 모체가 되는 인터페이스가 있는데, 이런 객체 생성 관리를 탐당하는 컨테이너 등에서 주로 이런 패턴을 자주 사용합니다. 예컨대 getBean 같은  것들을 통해서 빈 객체들을 받아올 수 있습니다.
```

</details>



<details>

<summary> 꼬리질문 2. </summary>

###### 꼬리질문 2. 보니까 예시는 추상 팩토리 패턴인데, 일반 팩토리 패턴과는 무슨 차이가 있나요?

```
팩토리 패턴은 그냥 하나의 객체를 생성하는 방법에 초점을 맞춰 추상화 계층을 추가해주는거고 추상 팩토리 패턴은 관련있는 객체 생성 그룹을 제공하기 위한 인터페이스를 추가해주는 개념입니다.
```

</details>




<details>

<summary> 꼬리질문 3. </summary>

###### 꼬리질문 3. 다른 객체 생성 패턴들이랑 같이 사용할 수도 있나요?
```
네! 당장 SPRING의 applcation context만 봐도 객체 풀링등에 사용되는 싱글톤이랑 방금 말씀드린 factory 패턴을 같이 사용하고 있습니다!
```

</details>


<details>

<summary> 꼬리질문 4. </summary>
    
###### 꼬리질문 4. 이 예시를 구현하면서 자연스럽게 OCP를 사용하셨는데 느끼신 단점은 없으셨나요?
```
OCP를 준수한다는 건 결국 그 안에서 사용되는 모든 객체에 대해 추상화를 진행해야 한다는건데, 이게 생각보다 굉장히 불편했습니다. 당장 AppConfig에 등록하는 부분만 하더라도 추상 팩토리 디자인 패턴이랑
같이 쓰려고 하니까 사실 저 예시에서도 test thread에서 사용하는 객체가 많을수록 효과가 더 극명하게 보여서, 6개 정도로 하려고 했는데 그 과정이 너무 복잡해서 포기했습니다.
```


</details>


<details>


<summary>꼬리질문 5. </summary>

###### 꼬리질문 5. 생성 관련 패턴 중에 다른것도 있는 걸로 알고있는데 무슨 차이가 있나요?
```
간단하게 설명드리면 팩토리 패턴은 특정 작업 수행에 필요한 객체 세트 생성을 서브 클래스에 맡겨 유연성을 높이는 구조입니다. 싱글톤은 하나의 객체만 생성해두고 그 객체 하나만 내려주는 생성 방식이고, 빌더 패턴은 객체 생성을 유연하게 하는 걸 돕는 사
패턴입니다. 프로토타입은 복제를 통해서 생성을 다루는 패턴입니다. 사실 비교라는 걸 하려면 유사한 부분이 있어야하는데 전혀 다른 목적으로 쓰이는 패턴들이어서 객체 생성 방법 외에는 차이라고 할 것도 명확히 표현하기 어렵습니다.
```

</details>


<br>

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#### (2) [Singleton Pattern]
> ##### 객체를 미리 생성해두고, 그 하나의 객체만 내려주는 패턴입니다. 관련 코드는 [여기](https://github.com/choichanhyeok/just-java-note/tree/master/src/main/java/org/example/designPattern/singleton/whyNeedSingleton)에 작성했습니다.
```
데이터베이스 커넥션 풀 처럼 객체들을 요청에 따라 제공하는 경우에 모든 요청마다 객체를 생성한다면 객체 생성하고 해제하는데 들어가는 시간이 많이 들 것입니다. 그래서 이를 위해 객체들을 미리 생성해두고 요청에 따라 할당하게 되면 요청자가 좀 더 기다릴 순 있겠지만
메모리 과부하로 인한 OOME를 방지할 수 있습니다.
```

![image](https://github.com/chanHyeoks-kingdom/f-lab-history/assets/68278903/a82b384f-9723-4c06-8387-ecd3d4ebac43)

![image](https://github.com/chanHyeoks-kingdom/f-lab-history/assets/68278903/6dee176d-92f7-42c8-a686-1e331cb5781e)


<br>

<details>
    <summary> 꼬리질문 1. </summary>

##### 꼬리질문 1. 싱글톤 패턴의 장단점은 무엇인가요?
```
[장점]
a. 자원을 중복해서 생성할 때, 그러니까 위 첨부한 코드처럼 객체 같은 것들을 생성, 해제 하는 비용을 아낄 수 있다는 점입니다. 
b. 특정 자원, 그러니까 객체에 대한 접근을 하나의 클래스에서 처리할 수 있어서 제공할 객체를 교체 할 때 등의 상황에서 인터페이스와 함께 적용하면 유지보수성을 높일 수 있습니다.
```

```
[단점]
a. 일단 하나의 자원을 공유하는 순간부터 동시성 문제는 필연적으로 발생할 수 밖에 없어서 이에 대한 처리가 필요합니다.
b. 전역 상태가 필요해서 코드들의 결합도가 증가하게 됩니다.
```

</details>

<details>
    <summary> 꼬리질문 2. </summary>

##### 꼬리질문 2. 싱글톤 패턴을 사용할 때 고려해야 할 디자인 이슈가 있을까요?
```
싱글톤을 사용 할 때 동시성이나 코드 결합도 문제가 있습니다. 동시성 문제는 double-checked locking 패턴등을 이용해 해결해봤는데, 코드 결합도 문제는 사실 기준을 잘 모르겠습니다.
이게 어쨌든 전역적으로 사용하게 돼서 여기저기서 사용하면 결합도가 높아질 수 있다는 개념인데 지금 생각으론 그냥 인터페이스로 추상화 해서 인터페이스를 통해 접근토록 하는 방법이 있을 거 같습니다.
```

    
</details>

<details>
    <summary> 꼬리질문 3. </summary>

##### 꼬리질문 3. 멀티스레드 환경에서 싱글톤은 어떻게 안전하게 사용할 수 있나요?
```
기존에 배운 synchronized 블록이나 volatile 키워드등을 이용해서 인스턴스 생성 시 발생하는 race-condition을 방지할 수 있습니다.
그 외에 dobule-checked locking등의 방법을 활용할 수도 있을 거 같습니다.
```

    
</details>

<details>
    <summary> 꼬리질문 4. </summary>

##### 꼬리질문 4. 싱글톤 패턴과 데이터베이스 커넥션 풀의 관계는 어떻게 설명할 수 있나요?
```
싱글톤 패턴은 데이터커넥션 풀 관리와 함께 사용될 경우 큰 이점을 가져갈 수 있습니다. 싱글톤은 동시성 이슈의 해결 방안으로 synchronized 같은 방법을
사용할 경우가 많은데 그로 인해 무조건 하나만 사용했을 땐 성능상 불이익을 가져갈 수 있습니다. 이 때 데이터베이스 커넥션 풀과 같은 풀의 요소로서 사용
될 경우 객체 관리 비용을 줄이면서 성능상 이점도 어느정도 보완갈 수 있습니다.
```

    
</details>

<details>
    <summary> 꼬리질문 5. </summary>

##### 꼬리질문 5. 싱글톤 인스턴스의 생성을 지연시키는 이유는 무엇인가요?
```
리소스 절약을 위해서입니다. 애플리케이션이 시작할 때 부터 생성해두면 '초기 로딩 시간'을 늦출 수 있는데 이런 부분을 해결할 수 있습니다.
```

    
</details>

<details>
    <summary> 꼬리질문 6. </summary>

##### 꼬리질문 6. 싱글톤 패턴을 사용하지 않고 데이터베이스 커넥션을 관리하는 다른 방법은 무엇인가요?
```
HikariCp 같은 연결 풀 라이브러리를 사용하거나 DI를 이용하는 방법도 있는데 사실 이게 싱글톤 패턴이랑 완전히 분리된 개념들은 아니라고 생각합니다.
```

    
</details>


<details>
    <summary> 꼬리질문 7. </summary>

##### 꼬리질문 7. 스프링에서도 Application Context를 이용해 DI를 제공하지 않나요? 어떤식으로 싱글톤의 단점을 보완하나요?
```
일단 인터페이스 기반의 추상화와 DI를 통해 결합도를 감소시키고 내부적으로 동기화 문제를 해결해줍니다.
```

    
</details>



<br><br>
#### (3) [Adapter Pattern]



<br>

### 2. 스프링의 IoC(Inversion of Control)과 DI(Dependency Injection)에 대해 설명하시오
> Ioc라는 건 ..
```

```
<br>

### 3. 스프링 빈 주입 방법에 대해 설명하시오
> Bean을 주입하는 방법은 ..
```

```
<br>

### 4. Spring AOP(Aspect-Oriented Programming)에 대해 설명하시오
> 먼저 AOP 라는 건 ..
```

```
<br>

### 5. Git Branch 전략에 대해 설명하시오 (eg. git flow, github flow, etc)
> Git branch는 ..
```

```
<br>
